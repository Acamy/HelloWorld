function [X Y]=rk4(f,g,a,b,x0,y0,h)
M=fix((b-a)/h);
T=zeros(1,M+1);
X=zeros(1,M+1);
Y=zeros(1,M+1);
T=a:h:b;
X(1)=x0;
Y(1)=y0;
for j=1:M
    f1=feval(f,T(j),X(j),Y(j));
    g1=feval(g,T(j),X(j),Y(j));
    f2=feval(f,T(j)+h/2,X(j)+f1/2,Y(j)+g1/2);
    g2=feval(g,T(j)+h/2,X(j)+f1/2,Y(j)+g1/2);
    f3=feval(f,T(j)+h/2,X(j)+f2/2,Y(j)+g2/2);
    g3=feval(g,T(j)+h/2,X(j)+f2/2,Y(j)+g2/2);
    f4=feval(f,T(j)+h,X(j)+f3,Y(j)+g3);
    g4=feval(g,T(j)+h,X(j)+f3,Y(j)+g3);
    X(j+1)=X(j)+(f1+2*f2+2*f3+f4)/6;
    Y(j+1)=Y(j)+(g1+2*g2+2*g3+g4)/6;
end
